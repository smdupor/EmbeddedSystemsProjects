* R8C/Tiny,M16C/60 SERIES ASSEMBLER *   SOURCE LIST       Thu Jan 24 13:54:52 2008  PAGE 001

  SEQ.  LOC.   OBJ.              0XMSDA ....*....SOURCE STATEMENT....7....*....8....*....9....*....0....*....1....*....2....*....3....*....4

     1                                  ;*************************************************************************** ;
     2                                  ; C COMPILER for R8C/Tiny, M16C/60,30,20,10
     3                                  ; Copyright(C) 1999(2000-2004). Renesas Technology Corp.
     4                                  ; and Renesas Solutions Corp., All rights reserved.
     5                                  ;
     6                                  ;
     7                                  ; ncrt0.a30 : NC30 startup program
     8                                  ;
     9                                  ; This program is applicable when using the basic I/O library
    10                                  ;       
    11                                  ; $Id: ncrt0.a30,v 1.27.4.4 2004/10/29 14:06:38 simomura Exp $
    12                                  ;
    13                                  ;***************************************************************************
    14                                  
    15                                  ;--------------------------------------------------------------------
    16                                  ; set size of monitor area for FoUSB
    17                                  ;--------------------------------------------------------------------
    18                                  .if	_KD_
    19                                  .if	_Firmware_space == 0
    20                                  .else
    21  00000600h                       FoUSB_MON	.equ	_Firmware_space
    22                                  .endif
    23                                  .endif
    24                                  ;---------------------------------------------------------------------
    25                                  ; HEEP SIZE definition
    26                                  ;---------------------------------------------------------------------
    27                                  .if	__HEAP__ == 1 
    28                                  .else
    29                                  
    30                                  .if	__HEAPSIZE__ == 0
    31                                  .else
    32  00000300h                       HEAPSIZE	.equ	__HEAPSIZE__
    33                                  .endif
    34                                  
    35                                  .endif
    36                                  
    37                                  ;---------------------------------------------------------------------
    38                                  ; STACK SIZE definition
    39                                  ;---------------------------------------------------------------------
    40                                  .if	__USTACKSIZE__ == 0
    41                            X     .if	__R8C__ != 1
    42                            X     .else
    43                            X     .endif
    44                                  .else
    45  00000300h                       STACKSIZE	.equ	__USTACKSIZE__
    46                                  .endif
    47                                  
    48                                  ;---------------------------------------------------------------------
    49                                  ; INTERRUPT STACK SIZE definition
    50                                  ;---------------------------------------------------------------------
    51                                  .if	__ISTACKSIZE__ == 0
    52                            X     .if	__R8C__ != 1
    53                            X     .else
    54                            X     .endif
    55                                  .else
    56  00000300h                       ISTACKSIZE	.equ	__ISTACKSIZE__
    57                                  .endif
    58                                  
    59                                  ;---------------------------------------------------------------------
    60                                  ; INTERRUPT VECTOR ADDRESS  definition
    61                                  ;---------------------------------------------------------------------
    62                                  .if	__R8C__ != 1
* R8C/Tiny,M16C/60 SERIES ASSEMBLER *   SOURCE LIST       Thu Jan 24 13:54:52 2008  PAGE 002

  SEQ.  LOC.   OBJ.              0XMSDA ....*....SOURCE STATEMENT....7....*....8....*....9....*....0....*....1....*....2....*....3....*....4

    63                                  .if	_KD_ == 1
    64                                  	; for FoUSB's monitor area
    65                                  	; 64 is variable vector's number
    66                                  	; 4 is each vector's size
    67  000FBD00h                       VECTOR_ADR 	.equ	0fbe00h - (64*4)
    68  000FC400h                       SVECTOR_ADR 	.equ	(0fbe00h + FoUSB_MON)
    69                                  .else
    70                                  .endif // _KD_
    71                                  .else
    72                                  .endif
    73                                  
    74                                  ;---------------------------------------------------------------------
    75                                  ; Section allocation
    76                                  ;---------------------------------------------------------------------
    77                                  	.list OFF
    78                                  	.list ON
    79                                  
    80                                  ;---------------------------------------------------------------------
    81                                  ; SBDATA area definition
    82                                  ;---------------------------------------------------------------------
    83                                  	.glb	__SB__
    84  00000500h                       __SB__	.equ	data_SE_top
    85                                  
    86                                  ;====================================================================
    87                                  ; Initialize Macro declaration
    88                                  ;---------------------------------------------------------------------
    89                             D    N_BZERO	.macro	TOP_ ,SECT_
    90                             D    	mov.b	#00H, R0L
    91                             D    	mov.w	#(TOP_ & 0FFFFH), A1
    92                             D    	mov.w	#sizeof SECT_ , R3
    93                             D    	sstr.b	
    94                                  	.endm
    95                                  
    96                             D    N_BCOPY .macro	FROM_,TO_,SECT_
    97                             D    	mov.w	#(FROM_ & 0FFFFH),A0
    98                             D    	mov.b	#(FROM_ >>16),R1H
    99                             D    	mov.w	#TO_ ,A1
   100                             D    	mov.w	#sizeof SECT_ , R3
   101                             D    	smovf.b
   102                                  	.endm
   103                                  
   104                             D    BZERO	.macro	TOP_,SECT_
   105                             D    	push.w	#sizeof SECT_ >> 16
   106                             D    	push.w	#sizeof SECT_  & 0ffffh
   107                             D    	pusha	TOP_ >>16
   108                             D    	pusha	TOP_ & 0ffffh
   109                             D    	.stk	8
   110                             D    	.glb	_bzero	
   111                             D    	.call	_bzero,G
   112                             D    	jsr.a	_bzero
   113                                  	.endm
   114                                  
   115                             D    BCOPY	.macro	FROM_ ,TO_ ,SECT_
   116                             D    	push.w	#sizeof SECT_  >> 16
   117                             D    	push.w	#sizeof SECT_  & 0ffffh
   118                             D    	pusha	TO_ >>16
   119                             D    	pusha	TO_  & 0ffffh
   120                             D    	pusha	FROM_ >>16
   121                             D    	pusha	FROM_  & 0ffffh
   122                             D    	.stk	12
   123                             D    	.glb	_bcopy
   124                             D    	.call   _bcopy,G
* R8C/Tiny,M16C/60 SERIES ASSEMBLER *   SOURCE LIST       Thu Jan 24 13:54:52 2008  PAGE 003

  SEQ.  LOC.   OBJ.              0XMSDA ....*....SOURCE STATEMENT....7....*....8....*....9....*....0....*....1....*....2....*....3....*....4

   125                             D    	jsr.a	_bcopy
   126                                  	.endm
   127                                  
   128                                  .if	__R8C__ != 1
   129                                  ;
   130                                  ; for M16C/60,30,20,10 series
   131                                  ;
   132                                  ;		.glb	__BankSelect
   133                                  ;__BankSelect	.equ	0BH
   134                                  
   135                                  ;---------------------------------------------------------------
   136                                  ; special page definition
   137                                  ;---------------------------------------------------------------
   138                                  ;       macro define for special page
   139                                  ;
   140                                  ;Format:
   141                                  ;	SPECIAL	number
   142                                  ;
   143                                  
   144                             D    SPECIAL	.macro	NUM
   145                             D    	.org	0FFFFEH-(NUM*2)
   146                             D    	.glb	__SPECIAL_@NUM
   147                             D    	.word	__SPECIAL_@NUM  & 0FFFFH
   148                                  .endm
   149                                  ;====================================================================
   150                                  ; Interrupt section start
   151                                  ;---------------------------------------------------------------------
   152                                  	.insf	start,S,0
   153                                  	.glb	start
   154                                  	.section	interrupt
   155  00000                           start:
   156                                  ;---------------------------------------------------------------------
   157                                  ; after reset,this program will start
   158                                  ;---------------------------------------------------------------------
   159  00000  EB400000r                	ldc	#istack_top,	isp	;set istack pointer
   160  00004  C7020A00              S  	mov.b	#02h,0ah
   161  00008  B70400                Z  	mov.b	#00h,04h		;set processer mode 
   162  0000B  B70A00                Z  	mov.b	#00h,0ah
   163  0000E  EB308000                 	ldc	#0080h,	flg
   164  00012  EB500000r                	ldc	#stack_top,	sp	;set stack pointer 
   165  00016  EB600005                 	ldc	#data_SE_top,	sb	;set sb register 
   166  0001A  EB200F00                 	ldintb	#VECTOR_ADR
               EB1000BD 
   167  00022  EB64                     	fset	i
   168                                  
   169                                  ;====================================================================
   170                                  ; NEAR area initialize.
   171                                  ;--------------------------------------------------------------------
   172                                  ; bss zero clear
   173                                  ;--------------------------------------------------------------------
   174                                  	N_BZERO	bss_SE_top,bss_SE
   175  00024  B4                  M Z  	mov.b	#00H, R0L
   176  00025  AA0000r             M S  	mov.w	#(bss_SE_top & 0FFFFH), A1
   177  00028  75C30000r           M    	mov.w	#sizeof bss_SE , R3
   178  0002C  7CEA                M    	sstr.b	
   179                             M    	.endm
   180                                  	N_BZERO	bss_SO_top,bss_SO
   181  0002E  B4                  M Z  	mov.b	#00H, R0L
   182  0002F  AA0000r             M S  	mov.w	#(bss_SO_top & 0FFFFH), A1
   183  00032  75C30000r           M    	mov.w	#sizeof bss_SO , R3
   184  00036  7CEA                M    	sstr.b	
   185                             M    	.endm
* R8C/Tiny,M16C/60 SERIES ASSEMBLER *   SOURCE LIST       Thu Jan 24 13:54:52 2008  PAGE 004

  SEQ.  LOC.   OBJ.              0XMSDA ....*....SOURCE STATEMENT....7....*....8....*....9....*....0....*....1....*....2....*....3....*....4

   186                                  	N_BZERO	bss_NE_top,bss_NE
   187  00038  B4                  M Z  	mov.b	#00H, R0L
   188  00039  AA0000r             M S  	mov.w	#(bss_NE_top & 0FFFFH), A1
   189  0003C  75C30000r           M    	mov.w	#sizeof bss_NE , R3
   190  00040  7CEA                M    	sstr.b	
   191                             M    	.endm
   192                                  	N_BZERO	bss_NO_top,bss_NO
   193  00042  B4                  M Z  	mov.b	#00H, R0L
   194  00043  AA0000r             M S  	mov.w	#(bss_NO_top & 0FFFFH), A1
   195  00046  75C30000r           M    	mov.w	#sizeof bss_NO , R3
   196  0004A  7CEA                M    	sstr.b	
   197                             M    	.endm
   198                                  
   199                                  ;---------------------------------------------------------------------
   200                                  ; initialize data section
   201                                  ;---------------------------------------------------------------------
   202                                  	N_BCOPY data_SEI_top,data_SE_top,data_SE
   203  0004C  A20000r             M S  	mov.w	#(data_SEI_top & 0FFFFH),A0
   204  0004F  74C300r             M    	mov.b	#(data_SEI_top >>16),R1H
   205  00052  AA0005              M S  	mov.w	#data_SE_top ,A1
   206  00055  75C30000r           M    	mov.w	#sizeof data_SE , R3
   207  00059  7CE8                M    	smovf.b
   208                             M    	.endm
   209                                  	N_BCOPY	data_SOI_top,data_SO_top,data_SO
   210  0005B  A20000r             M S  	mov.w	#(data_SOI_top & 0FFFFH),A0
   211  0005E  74C300r             M    	mov.b	#(data_SOI_top >>16),R1H
   212  00061  AA0000r             M S  	mov.w	#data_SO_top ,A1
   213  00064  75C30000r           M    	mov.w	#sizeof data_SO , R3
   214  00068  7CE8                M    	smovf.b
   215                             M    	.endm
   216                                  	N_BCOPY	data_NEI_top,data_NE_top,data_NE
   217  0006A  A20000r             M S  	mov.w	#(data_NEI_top & 0FFFFH),A0
   218  0006D  74C300r             M    	mov.b	#(data_NEI_top >>16),R1H
   219  00070  AA0000r             M S  	mov.w	#data_NE_top ,A1
   220  00073  75C30000r           M    	mov.w	#sizeof data_NE , R3
   221  00077  7CE8                M    	smovf.b
   222                             M    	.endm
   223                                  	N_BCOPY	data_NOI_top,data_NO_top,data_NO
   224  00079  A20000r             M S  	mov.w	#(data_NOI_top & 0FFFFH),A0
   225  0007C  74C300r             M    	mov.b	#(data_NOI_top >>16),R1H
   226  0007F  AA0000r             M S  	mov.w	#data_NO_top ,A1
   227  00082  75C30000r           M    	mov.w	#sizeof data_NO , R3
   228  00086  7CE8                M    	smovf.b
   229                             M    	.endm
   230                                  
   231                                  ;====================================================================
   232                                  ; FAR area initialize.
   233                                  ;---------------------------------------------------------------------
   234                                  ; bss zero clear
   235                                  ;---------------------------------------------------------------------
   236                                  	BZERO	bss_FE_top,bss_FE
   237  00088  7DE20000r           M    	push.w	#sizeof bss_FE >> 16
   238  0008C  7DE20000r           M    	push.w	#sizeof bss_FE  & 0ffffh
   239  00090  7D9F0000r           M    	pusha	bss_FE_top >>16
   240  00094  7D9F0000r           M    	pusha	bss_FE_top & 0ffffh
   241                             M    	.stk	8
   242                             M    	.glb	_bzero	
   243                             M    	.call	_bzero,G
   244  00098  FD000000r           M A  	jsr.a	_bzero
   245                             M    	.endm
   246                                  	BZERO	bss_FO_top,bss_FO
   247  0009C  7DE20000r           M    	push.w	#sizeof bss_FO >> 16
* R8C/Tiny,M16C/60 SERIES ASSEMBLER *   SOURCE LIST       Thu Jan 24 13:54:52 2008  PAGE 005

  SEQ.  LOC.   OBJ.              0XMSDA ....*....SOURCE STATEMENT....7....*....8....*....9....*....0....*....1....*....2....*....3....*....4

   248  000A0  7DE20000r           M    	push.w	#sizeof bss_FO  & 0ffffh
   249  000A4  7D9F0000r           M    	pusha	bss_FO_top >>16
   250  000A8  7D9F0000r           M    	pusha	bss_FO_top & 0ffffh
   251                             M    	.stk	8
   252                             M    	.glb	_bzero	
   253                             M    	.call	_bzero,G
   254  000AC  FD000000r           M A  	jsr.a	_bzero
   255                             M    	.endm
   256                                  
   257                                  ;---------------------------------------------------------------------
   258                                  ; Copy edata_E(O) section from edata_EI(OI) section
   259                                  ;---------------------------------------------------------------------
   260                                  	BCOPY	data_FEI_top,data_FE_top,data_FE
   261  000B0  7DE20000r           M    	push.w	#sizeof data_FE  >> 16
   262  000B4  7DE20000r           M    	push.w	#sizeof data_FE  & 0ffffh
   263  000B8  7D9F0F00            M    	pusha	data_FE_top >>16
   264  000BC  7D9F00B0            M    	pusha	data_FE_top  & 0ffffh
   265  000C0  7D9F0000r           M    	pusha	data_FEI_top >>16
   266  000C4  7D9F0000r           M    	pusha	data_FEI_top  & 0ffffh
   267                             M    	.stk	12
   268                             M    	.glb	_bcopy
   269                             M    	.call   _bcopy,G
   270  000C8  FD000000r           M A  	jsr.a	_bcopy
   271                             M    	.endm
   272                                  	BCOPY	data_FOI_top,data_FO_top,data_FO
   273  000CC  7DE20000r           M    	push.w	#sizeof data_FO  >> 16
   274  000D0  7DE20000r           M    	push.w	#sizeof data_FO  & 0ffffh
   275  000D4  7D9F0000r           M    	pusha	data_FO_top >>16
   276  000D8  7D9F0000r           M    	pusha	data_FO_top  & 0ffffh
   277  000DC  7D9F0000r           M    	pusha	data_FOI_top >>16
   278  000E0  7D9F0000r           M    	pusha	data_FOI_top  & 0ffffh
   279                             M    	.stk	12
   280                             M    	.glb	_bcopy
   281                             M    	.call   _bcopy,G
   282  000E4  FD000000r           M A  	jsr.a	_bcopy
   283                             M    	.endm
   284                                  
   285  000E8  EB500000r                	ldc	#stack_top,sp
   286                                  	.stk	-40
   287                                  
   288                                  ;====================================================================
   289                                  ; heap area initialize
   290                                  ;---------------------------------------------------------------------
   291                                  .if __HEAP__ != 1
   292                                  	.glb	__mbase
   293                                  	.glb	__mnext
   294                                  	.glb	__msize
   295  000EC  75CF0000r0000r           	mov.w	#(heap_top&0FFFFH), __mbase
   296  000F2  75CF0000r0000r           	mov.w	#(heap_top>>16), __mbase+2
   297  000F8  75CF0000r0000r           	mov.w	#(heap_top&0FFFFH), __mnext
   298  000FE  75CF0000r0000r           	mov.w	#(heap_top>>16), __mnext+2
   299  00104  75CF0000r0003            	mov.w	#(HEAPSIZE&0FFFFH), __msize
   300  0010A  D90F0000r             Q  	mov.w	#(HEAPSIZE>>16), __msize+2
   301                                  .endif
   302                                  
   303                                  ;====================================================================
   304                                  ; Initialize standard I/O
   305                                  ;---------------------------------------------------------------------
   306                                  .if __STANDARD_IO__ == 1
   307                                  .endif
   308                                  
   309                                  ;====================================================================
* R8C/Tiny,M16C/60 SERIES ASSEMBLER *   SOURCE LIST       Thu Jan 24 13:54:52 2008  PAGE 006

  SEQ.  LOC.   OBJ.              0XMSDA ....*....SOURCE STATEMENT....7....*....8....*....9....*....0....*....1....*....2....*....3....*....4

   310                                  ; Call main() function
   311                                  ;---------------------------------------------------------------------
   312  0010E  EB700000                 	ldc	#0h,fb	; for debuger
   313                                  
   314                                  	.glb	_main
   315  00112  FD000000r             A  	jsr.a	_main
   316                                  
   317                                  .else	; __R8C__
   318                            X     .if __HEAP__ != 1
   319                            X     .endif
   320                            X     .if __STANDARD_IO__ == 1
   321                            X     .endif
   322                                  .endif	; __R8C__
   323                                  
   324                                  ;====================================================================
   325                                  ; exit() function
   326                                  ;---------------------------------------------------------------------
   327                                  	.glb	_exit
   328                                  	.glb	$exit
   329  00116                           _exit:			   ; End program
   330  00116                           $exit:
   331  00116  FEFF                  B  	jmp	_exit
   332                                  	.einsf
   333                                  ;====================================================================
   334                                  ; dummy interrupt function
   335                                  ;---------------------------------------------------------------------
   336                                  	.glb	dummy_int
   337  00118                           dummy_int:
   338  00118  FB                       	reit
   339                                  
   340                                  	.end

Information List

TOTAL ERROR(S)    00000
TOTAL WARNING(S)  00000
TOTAL LINE(S)     00340   LINES

Section List

Attr        Size          Name
DATA     0000000(00000H)  data_SE
DATA     0000000(00000H)  bss_SE
DATA     0000000(00000H)  data_SO
DATA     0000000(00000H)  bss_SO
DATA     0000000(00000H)  data_NE
DATA     0000000(00000H)  bss_NE
DATA     0000000(00000H)  data_NO
DATA     0000000(00000H)  bss_NO
DATA     0001536(00600H)  stack
DATA     0000768(00300H)  heap
ROMDATA  0000000(00000H)  rom_NE
ROMDATA  0000000(00000H)  rom_NO
DATA     0000000(00000H)  data_FE
DATA     0000000(00000H)  bss_FE
DATA     0000000(00000H)  data_FO
DATA     0000000(00000H)  bss_FO
ROMDATA  0000000(00000H)  rom_FE
ROMDATA  0000000(00000H)  rom_FO
ROMDATA  0000000(00000H)  data_SEI
ROMDATA  0000000(00000H)  data_SOI
ROMDATA  0000000(00000H)  data_NEI
ROMDATA  0000000(00000H)  data_NOI
ROMDATA  0000000(00000H)  data_FEI
ROMDATA  0000000(00000H)  data_FOI
ROMDATA  0000000(00000H)  switch_table
CODE     0000000(00000H)  program
CODE     0000000(00000H)  interrupt
CODE     0000000(00000H)  program_S
ROMDATA  0000256(00100H)  vector
ROMDATA  0000000(00000H)  svector
ROMDATA  0000004(00004H)  fvector
CODE     0000281(00119H)  interrupt
